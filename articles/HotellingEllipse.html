<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HotellingEllipse • HotellingEllipse</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="HotellingEllipse">
<meta property="og:description" content="HotellingEllipse">
<meta property="og:image" content="https://pkgdown.r-lib.org, https://github.com/ChristianGoueguel/HotellingEllipse/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">HotellingEllipse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/HotellingEllipse.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ChristianGoueguel/HotellingEllipse/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>HotellingEllipse</h1>
                        <h4 data-toc-skip class="author">Christian L.
Goueguel</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ChristianGoueguel/HotellingEllipse/blob/HEAD/vignettes/HotellingEllipse.Rmd" class="external-link"><code>vignettes/HotellingEllipse.Rmd</code></a></small>
      <div class="hidden name"><code>HotellingEllipse.Rmd</code></div>

    </div>

    
    
<p>This package is specifically designed to help draw Hotelling’s
T-squared ellipses on PCA or PLS score scatterplots, a crucial tool in
chemometrics for multivariate data analysis and quality control. In the
field of chemometrics, these ellipses serve as powerful visual aids for
measurements assessment, outlier detection, and process monitoring. By
superimposing Hotelling’s T-squared ellipses onto score plots, analysts
can quickly identify abnormal samples and establish well-defined
confidence regions for normal process operations.</p>
<p>The package’s functionality enables computing the Hotelling’s
T-squared statistic, the semi-minor and semi-major axes of the
otelling’s T-squared ellipse, and generates the coordinate points
necessary for constructing a confidence ellipse. Specifically, the
package provides two primary functions:</p>
<ul>
<li><p><code><a href="../reference/ellipseParam.html">ellipseParam()</a></code>, is used to calculate the Hotelling’s
T-squared statistic and the semi-axes of the confidence ellipses at 99%
and 95% confidence intervals.</p></li>
<li><p><code><a href="../reference/ellipseCoord.html">ellipseCoord()</a></code>, is primarily used to get the
<em>x</em>, <em>y</em>, and <em>z</em> coordinates for plotting 2D or 3D
confidence ellipses at user-defined confidence interval. The confidence
interval is set at 95% by default.</p></li>
</ul>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ChristianGoueguel/HotellingEllipse" class="external-link">HotellingEllipse</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"specData"</span>, package <span class="op">=</span> <span class="st">"HotellingEllipse"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="principal-component-analysis">Principal component analysis<a class="anchor" aria-label="anchor" href="#principal-component-analysis"></a>
</h2>
<p>In this example, we use <code><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html" class="external-link">FactoMineR::PCA()</a></code> to perform the
Principal Component Analysis (PCA) on a LIBS spectral dataset
<code>specData</code>, and extract the PCA scores.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">002</span><span class="op">)</span></span>
<span><span class="va">pca_mod</span> <span class="op">&lt;-</span> <span class="va">specData</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">PCA</span><span class="op">(</span>scale.unit <span class="op">=</span> <span class="cn">FALSE</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pca_scores</span> <span class="op">&lt;-</span> <span class="va">pca_mod</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"ind"</span>, <span class="st">"coord"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 100 × 5</span></span></span>
<span><span class="co">#&gt;      Dim.1    Dim.2  Dim.3   Dim.4 Dim.5</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="text-decoration: underline;">25</span>306.  -<span style="color: #BB0000; text-decoration: underline;">10</span><span style="color: #BB0000;">831.</span>  -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">851.</span>   -<span style="color: #BB0000;">83.4</span> -<span style="color: #BB0000;">560.</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   -<span style="color: #BB0000;">67.3</span>   <span style="text-decoration: underline;">1</span>137.  -<span style="color: #BB0000; text-decoration: underline;">2</span><span style="color: #BB0000;">946.</span>  <span style="text-decoration: underline;">2</span>495.  -<span style="color: #BB0000;">568.</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">822.</span>     -<span style="color: #BB0000;">22.0</span> -<span style="color: #BB0000; text-decoration: underline;">2</span><span style="color: #BB0000;">305.</span>  <span style="text-decoration: underline;">1</span>640.  -<span style="color: #BB0000;">409.</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">238.</span>    <span style="text-decoration: underline;">3</span>734.   <span style="text-decoration: underline;">4</span>039. -<span style="color: #BB0000; text-decoration: underline;">2</span><span style="color: #BB0000;">428.</span>   379.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">3</span>299.    <span style="text-decoration: underline;">4</span>727.   -<span style="color: #BB0000;">888.</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">089.</span>   262.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">5</span>006.     -<span style="color: #BB0000;">49.5</span>  <span style="text-decoration: underline;">2</span>534.  <span style="text-decoration: underline;">1</span>917.  -<span style="color: #BB0000;">970.</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000; text-decoration: underline;">8</span><span style="color: #BB0000;">325.</span>   -<span style="color: #BB0000; text-decoration: underline;">5</span><span style="color: #BB0000;">607.</span>    960. -<span style="color: #BB0000; text-decoration: underline;">3</span><span style="color: #BB0000;">361.</span>   103.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000; text-decoration: underline;">4</span><span style="color: #BB0000;">955.</span>   -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">056.</span>   <span style="text-decoration: underline;">2</span>510.  -<span style="color: #BB0000;">397.</span>  -<span style="color: #BB0000;">354.</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">610.</span>    <span style="text-decoration: underline;">1</span>271.  -<span style="color: #BB0000; text-decoration: underline;">2</span><span style="color: #BB0000;">556.</span>  <span style="text-decoration: underline;">2</span>268.  -<span style="color: #BB0000;">760.</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="text-decoration: underline;">19</span>582.    <span style="text-decoration: underline;">2</span>289.    886.  -<span style="color: #BB0000;">843.</span>  <span style="text-decoration: underline;">1</span>483.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 90 more rows</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="hotellings-t-squared-statistic">Hotelling’s T-Squared Statistic<a class="anchor" aria-label="anchor" href="#hotellings-t-squared-statistic"></a>
</h2>
<p>The Hotelling’s T-squared statistic can be computed using the
<code>ellipseParam</code> function in two distinct ways. (1) By
specifying the parameter <code>k</code>: This represents the number of
principal components to retain. (2) By setting the
<code>threshold</code> parameter: This defines the cumulative explained
variance to determine the number of components.</p>
<div class="section level3">
<h3 id="calculate-using-the-first-k-components">Calculate using the first k components<a class="anchor" aria-label="anchor" href="#calculate-using-the-first-k-components"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">T2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ellipseParam.html">ellipseParam</a></span><span class="op">(</span><span class="va">pca_scores</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="va">Tsquare</span><span class="op">$</span><span class="va">value</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">T2</span></span>
<span><span class="co">#&gt;   [1] 8.79727659 0.42574446 0.26720102 1.12758053 0.73815225 0.50178543</span></span>
<span><span class="co">#&gt;   [7] 1.48895076 0.52248052 0.35995391 3.43505326 2.20554170 0.14665580</span></span>
<span><span class="co">#&gt;  [13] 1.23019477 1.08187330 0.06404802 0.82350867 4.12091044 0.18901522</span></span>
<span><span class="co">#&gt;  [19] 0.74937040 1.81186352 1.01387374 0.36322618 0.18201057 1.19587478</span></span>
<span><span class="co">#&gt;  [25] 0.82387604 0.59000025 1.64384908 1.35023679 0.04035757 1.07207307</span></span>
<span><span class="co">#&gt;  [31] 1.35289851 0.89287224 0.58566878 0.51087876 0.33557545 0.35322970</span></span>
<span><span class="co">#&gt;  [37] 2.75957814 0.73510967 0.42097537 0.65499771 0.41084500 0.26551834</span></span>
<span><span class="co">#&gt;  [43] 0.48229565 0.36048584 0.25235451 0.76994454 2.93735077 0.07159629</span></span>
<span><span class="co">#&gt;  [49] 0.15337115 0.09562119 0.12416659 0.41598605 0.38472295 0.21898479</span></span>
<span><span class="co">#&gt;  [55] 0.20860524 1.26153407 0.26389302 1.35227317 0.05781487 0.65100278</span></span>
<span><span class="co">#&gt;  [61] 2.61898699 0.94048980 1.60881058 1.02169526 0.41282496 0.27235598</span></span>
<span><span class="co">#&gt;  [67] 0.14854682 0.66617260 2.82560083 0.12785702 1.25327046 0.66607730</span></span>
<span><span class="co">#&gt;  [73] 1.22850658 1.13312107 1.46864227 1.46171265 0.10436499 0.26006454</span></span>
<span><span class="co">#&gt;  [79] 0.97128044 1.92028425 1.95885654 0.36084958 4.84793496 0.24714317</span></span>
<span><span class="co">#&gt;  [85] 0.55723720 0.64080960 1.87718652 0.14398651 0.50051409 0.43680390</span></span>
<span><span class="co">#&gt;  [91] 0.76213175 0.58130268 1.48307214 0.55700045 0.17208837 0.11091915</span></span>
<span><span class="co">#&gt;  [97] 0.76406153 0.66296513 0.11773916 1.40404240</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">T2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ellipseParam.html">ellipseParam</a></span><span class="op">(</span><span class="va">pca_scores</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">$</span><span class="va">Tsquare</span><span class="op">$</span><span class="va">value</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">T2</span></span>
<span><span class="co">#&gt;   [1] 5.35198031 0.80483847 0.41280666 1.09396270 0.54357239 1.05866612</span></span>
<span><span class="co">#&gt;   [7] 1.54758552 0.38932531 0.85084455 3.33998923 1.33661709 2.67345992</span></span>
<span><span class="co">#&gt;  [13] 1.44052380 0.74554569 0.09716023 0.63692986 3.03905923 0.14527271</span></span>
<span><span class="co">#&gt;  [19] 1.65973096 2.03032292 0.68825673 0.70721780 1.05449654 0.95268942</span></span>
<span><span class="co">#&gt;  [25] 0.67437285 0.51832530 1.60329970 1.65265923 0.46804197 1.61273965</span></span>
<span><span class="co">#&gt;  [31] 0.90591680 0.83720307 0.57655751 1.27928674 0.40830752 0.25568007</span></span>
<span><span class="co">#&gt;  [37] 1.92746313 0.43666648 0.42052805 0.53674167 0.33326678 0.31518697</span></span>
<span><span class="co">#&gt;  [43] 0.53420621 0.28056547 0.39345409 1.31456541 2.34976600 0.21583160</span></span>
<span><span class="co">#&gt;  [49] 0.19463398 0.06499698 0.76421962 0.82346628 0.60492739 0.25441618</span></span>
<span><span class="co">#&gt;  [55] 0.44826694 0.75245708 0.84507014 0.97855109 0.25134633 0.68527571</span></span>
<span><span class="co">#&gt;  [61] 2.26652396 1.59851453 1.12427685 0.84476325 0.25321959 0.44806235</span></span>
<span><span class="co">#&gt;  [67] 0.74685450 0.45892445 2.81481934 0.49094953 0.80909145 0.57714113</span></span>
<span><span class="co">#&gt;  [73] 0.77330414 0.74629051 1.84932002 0.88840206 0.46801132 0.33977349</span></span>
<span><span class="co">#&gt;  [79] 0.58104753 1.35207024 1.73787700 0.51984216 2.91262151 0.20476197</span></span>
<span><span class="co">#&gt;  [85] 0.70355158 0.55268503 1.63351195 0.24424689 0.55678461 1.86446207</span></span>
<span><span class="co">#&gt;  [91] 0.45875232 0.39755343 0.98469700 0.55441164 0.20947523 0.63142698</span></span>
<span><span class="co">#&gt;  [97] 0.71018219 0.51824037 0.17165582 0.88278586</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculate-using-the-cumulative-variance-threshold">Calculate using the cumulative variance threshold<a class="anchor" aria-label="anchor" href="#calculate-using-the-cumulative-variance-threshold"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">T2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ellipseParam.html">ellipseParam</a></span><span class="op">(</span><span class="va">pca_scores</span>, threshold <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span><span class="op">$</span><span class="va">Tsquare</span><span class="op">$</span><span class="va">value</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">T2</span></span>
<span><span class="co">#&gt;   [1] 13.098377222  0.053558139  0.042763017  0.596881084  1.064949043</span></span>
<span><span class="co">#&gt;   [6]  0.322634358  2.193588461  0.362201444  0.100269823  5.152202188</span></span>
<span><span class="co">#&gt;  [11]  0.136476512  0.187288163  0.457018299  0.836596116  0.037948942</span></span>
<span><span class="co">#&gt;  [16]  0.499423175  6.201798003  0.283938583  1.053279861  2.176093882</span></span>
<span><span class="co">#&gt;  [21]  1.495054754  0.328273167  0.001077433  0.385735197  0.770015903</span></span>
<span><span class="co">#&gt;  [26]  0.855099441  1.918512180  1.898354875  0.059730859  1.544579259</span></span>
<span><span class="co">#&gt;  [31]  2.032241146  1.336688195  0.733955470  0.192465562  0.189870642</span></span>
<span><span class="co">#&gt;  [36]  0.228768334  2.513724266  0.227842165  0.596628858  0.794052585</span></span>
<span><span class="co">#&gt;  [41]  0.579569949  0.180495608  0.375303017  0.101758464  0.290449128</span></span>
<span><span class="co">#&gt;  [46]  1.151911637  0.616332156  0.016266200  0.230869862  0.026046210</span></span>
<span><span class="co">#&gt;  [51]  0.181580829  0.187191855  0.318096039  0.049303079  0.301571988</span></span>
<span><span class="co">#&gt;  [56]  1.849456533  0.093358887  0.338259448  0.054705074  0.865871257</span></span>
<span><span class="co">#&gt;  [61]  3.419405506  0.932424618  1.363364796  0.870186313  0.512986568</span></span>
<span><span class="co">#&gt;  [66]  0.075112028  0.016206207  0.195475035  3.986477406  0.142755791</span></span>
<span><span class="co">#&gt;  [71]  0.379374196  0.809324698  1.859972412  0.058403575  1.958324315</span></span>
<span><span class="co">#&gt;  [76]  0.060646515  0.131828892  0.155979037  0.731558582  2.704001013</span></span>
<span><span class="co">#&gt;  [81]  0.243720099  0.546490035  6.914605380  0.369950255  0.425961362</span></span>
<span><span class="co">#&gt;  [86]  0.376793369  0.040293609  0.146837113  0.524107524  0.652320554</span></span>
<span><span class="co">#&gt;  [91]  0.013362935  0.319746716  1.968145064  0.729551769  0.214084611</span></span>
<span><span class="co">#&gt;  [96]  0.093838067  0.917982030  0.158779544  0.089226394  2.122042242</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">T2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ellipseParam.html">ellipseParam</a></span><span class="op">(</span><span class="va">pca_scores</span>, threshold <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">$</span><span class="va">Tsquare</span><span class="op">$</span><span class="va">value</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">T2</span></span>
<span><span class="co">#&gt;   [1] 6.53045498 0.77985914 0.39875666 1.27633910 0.63623773 0.64621852</span></span>
<span><span class="co">#&gt;   [7] 1.94706323 0.39955561 0.65027891 2.60270069 1.68777974 2.33832862</span></span>
<span><span class="co">#&gt;  [13] 1.73627591 0.89148735 0.09154971 0.61396625 3.74797974 0.14792815</span></span>
<span><span class="co">#&gt;  [19] 1.16098653 1.37203684 0.75262904 0.74133604 0.39917534 1.18375135</span></span>
<span><span class="co">#&gt;  [25] 0.84423117 0.49281117 2.02255319 1.09460844 0.09591725 0.96401329</span></span>
<span><span class="co">#&gt;  [31] 1.02350705 1.05620821 0.58298463 1.26807473 0.51557341 0.27067599</span></span>
<span><span class="co">#&gt;  [37] 2.41734914 0.54565033 0.47149967 0.56074231 0.36897968 0.39285391</span></span>
<span><span class="co">#&gt;  [43] 0.52187589 0.26763215 0.48000911 1.01010296 2.54789673 0.16441988</span></span>
<span><span class="co">#&gt;  [49] 0.11408734 0.07745065 0.89519603 1.01950514 0.59274496 0.25875285</span></span>
<span><span class="co">#&gt;  [55] 0.50533086 0.94128973 1.06662628 1.21217577 0.13332013 0.49597035</span></span>
<span><span class="co">#&gt;  [61] 2.49744440 1.05004728 1.20861993 0.82193478 0.31977530 0.36498547</span></span>
<span><span class="co">#&gt;  [67] 0.91019140 0.50545945 2.13281990 0.27229890 0.93957749 0.72809042</span></span>
<span><span class="co">#&gt;  [73] 0.94080967 0.89232795 1.12148274 1.12208355 0.58120095 0.24318126</span></span>
<span><span class="co">#&gt;  [79] 0.72706291 1.70413391 1.59117880 0.26850066 3.67343823 0.25443017</span></span>
<span><span class="co">#&gt;  [85] 0.75731684 0.48234231 1.94290842 0.11555869 0.37941945 1.20420583</span></span>
<span><span class="co">#&gt;  [91] 0.56964432 0.45545274 1.11992496 0.57298359 0.14954172 0.75681961</span></span>
<span><span class="co">#&gt;  [97] 0.89556581 0.49625512 0.14666752 1.05902198</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="hotellings-t-squared-ellipse">Hotelling’s T-Squared Ellipse<a class="anchor" aria-label="anchor" href="#hotellings-t-squared-ellipse"></a>
</h2>
<div class="section level3">
<h3 id="calculating-the-semi-axes">Calculating the semi-axes<a class="anchor" aria-label="anchor" href="#calculating-the-semi-axes"></a>
</h3>
<p>To visualize the confidence region for our multivariate data, we
employ the <code><a href="../reference/ellipseParam.html">ellipseParam()</a></code> function to generate a confidence
ellipse. Our objective is to calculate the lengths of the semi-axes for
this ellipse, focusing on the bivariate relationship within the PC2-PC4
subspace of our principal component analysis. We maintain the default
value for <code>k</code> (number of components) at 2. This ensures we’re
working with a two-dimensional representation. We specify
<code>pcx = 2</code> and <code>pcy = 4</code> as inputs. This directs
the function to use the 2nd and 4th principal components for the
<em>x</em> and <em>y</em> axes, respectively.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ellipse_axes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ellipseParam.html">ellipseParam</a></span><span class="op">(</span><span class="va">pca_scores</span>, pcx <span class="op">=</span> <span class="fl">2</span>, pcy <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">ellipse_axes</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 5</span></span>
<span><span class="co">#&gt;  $ Tsquare     : tibble [100 × 1] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   ..$ value: num [1:100] 13.0984 0.0536 0.0428 0.5969 1.0649 ...</span></span>
<span><span class="co">#&gt;  $ cutoff.99pct: num 9.76</span></span>
<span><span class="co">#&gt;  $ cutoff.95pct: num 6.24</span></span>
<span><span class="co">#&gt;  $ nb.comp     : num 2</span></span>
<span><span class="co">#&gt;  $ Ellipse     : tibble [1 × 4] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   ..$ a.99pct: num 10800</span></span>
<span><span class="co">#&gt;   ..$ b.99pct: num 5634</span></span>
<span><span class="co">#&gt;   ..$ a.95pct: num 8639</span></span>
<span><span class="co">#&gt;   ..$ b.95pct: num 4506</span></span></code></pre></div>
<p>We can extract parameters for further use:</p>
<ul>
<li>Semi-axes of the ellipse at 99% confidence level.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a1</span> <span class="op">&lt;-</span> <span class="va">ellipse_axes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">pluck</span><span class="op">(</span><span class="st">"Ellipse"</span>, <span class="st">"a.99pct"</span><span class="op">)</span></span>
<span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="va">ellipse_axes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">pluck</span><span class="op">(</span><span class="st">"Ellipse"</span>, <span class="st">"b.99pct"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Semi-axes of the ellipse at 95% confidence level.</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a2</span> <span class="op">&lt;-</span> <span class="va">ellipse_axes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">pluck</span><span class="op">(</span><span class="st">"Ellipse"</span>, <span class="st">"a.95pct"</span><span class="op">)</span></span>
<span><span class="va">b2</span> <span class="op">&lt;-</span> <span class="va">ellipse_axes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">pluck</span><span class="op">(</span><span class="st">"Ellipse"</span>, <span class="st">"b.95pct"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Hotelling’s T<span class="math inline">\(^2\)</span> statistic.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Tsq</span> <span class="op">&lt;-</span> <span class="va">ellipse_axes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">pluck</span><span class="op">(</span><span class="st">"Tsquare"</span>, <span class="st">"value"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pca_scores</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Dim.2</span>, y <span class="op">=</span> <span class="va">Dim.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ellipse</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x0 <span class="op">=</span> <span class="fl">0</span>, y0 <span class="op">=</span> <span class="fl">0</span>, a <span class="op">=</span> <span class="va">a1</span>, b <span class="op">=</span> <span class="va">b1</span>, angle <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">.5</span>, linetype <span class="op">=</span> <span class="st">"solid"</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_ellipse</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x0 <span class="op">=</span> <span class="fl">0</span>, y0 <span class="op">=</span> <span class="fl">0</span>, a <span class="op">=</span> <span class="va">a2</span>, b <span class="op">=</span> <span class="va">b2</span>, angle <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">.5</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Tsq</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_c</span><span class="op">(</span>option <span class="op">=</span> <span class="st">"viridis"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"solid"</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"solid"</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of PCA scores"</span>, </span>
<span>    subtitle <span class="op">=</span> <span class="st">"PC1 vs. PC3"</span>, </span>
<span>    x <span class="op">=</span> <span class="st">"PC2"</span>, </span>
<span>    y <span class="op">=</span> <span class="st">"PC4"</span>, </span>
<span>    fill <span class="op">=</span> <span class="st">"T2"</span>, </span>
<span>    caption <span class="op">=</span> <span class="st">"Figure 1"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_grey</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="HotellingEllipse_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="calculating-the-x-y-coordinates">Calculating the x-y coordinates<a class="anchor" aria-label="anchor" href="#calculating-the-x-y-coordinates"></a>
</h3>
<p>An alternative method for visualizing the Hotelling’s T-squared
confidence region is to utilize the <code><a href="../reference/ellipseCoord.html">ellipseCoord()</a></code>
function. This function generates the <em>x</em> and <em>y</em>
coordinates for plotting the confidence ellipse, offering greater
flexibility in visualization and further analysis. It allows users to
specify a custom confidence level via the <code>confi.limit</code>
parameter. The default confidence level is set at 95%, which is commonly
used in statistical analyses. The function returns a set of coordinates
that define the ellipse’s boundary in the chosen subspace, thereby
complementing the semi-axes information provided by the
<code><a href="../reference/ellipseParam.html">ellipseParam()</a></code> function.</p>
<p>In the example below, we focus on the subspace spanned by the 1st and
5th components.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xy_coord</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ellipseCoord.html">ellipseCoord</a></span><span class="op">(</span><span class="va">pca_scores</span>, pcx <span class="op">=</span> <span class="fl">1</span>, pcy <span class="op">=</span> <span class="fl">5</span>, conf.limit <span class="op">=</span> <span class="fl">0.975</span>, pts <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">xy_coord</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble [500 × 2] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ x: num [1:500] 17253 17252 17248 17241 17231 ...</span></span>
<span><span class="co">#&gt;  $ y: num [1:500] -3.75e-12 2.01e+01 4.02e+01 6.04e+01 8.05e+01 ...</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_polygon</span><span class="op">(</span>data <span class="op">=</span> <span class="va">xy_coord</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">pca_scores</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Dim.1</span>, y <span class="op">=</span> <span class="va">Dim.5</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">5</span>, fill <span class="op">=</span> <span class="st">"blue"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"solid"</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"solid"</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Scatterplot of PCA scores"</span>, </span>
<span>    subtitle <span class="op">=</span> <span class="st">"PC1 vs. PC5"</span>, </span>
<span>    x <span class="op">=</span> <span class="st">"PC1"</span>, </span>
<span>    y <span class="op">=</span> <span class="st">"PC5"</span>, </span>
<span>    caption <span class="op">=</span> <span class="st">"Figure 2"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_grey</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="HotellingEllipse_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="hotellings-t-squared-ellipsoid">Hotelling’s T-Squared Ellipsoid<a class="anchor" aria-label="anchor" href="#hotellings-t-squared-ellipsoid"></a>
</h2>
<p>The <code>ellipseCoord</code> function offers an optional parameter
<code>pcz</code>. When activated, this parameter extends the function’s
capabilities from two-dimensional ellipses to three-dimensional
ellipsoids, providing a more comprehensive visualization of multivariate
data, particularly in situation where the first two principal components
do not adequately capture the data’s variability.</p>
<div class="section level3">
<h3 id="calculating-the-x-y-z-coordinates">Calculating the x-y-z coordinates<a class="anchor" aria-label="anchor" href="#calculating-the-x-y-z-coordinates"></a>
</h3>
<p>In the example below, the resulting 3D Hotelling’s T-squared
ellipsoid serves as a volumetric confidence region in the subspace
spanned by the 1st, 2nd, and 3rd components. It encapsulates a specified
proportion of data points, determined by the confidence level, providing
a more holistic view of the data’s distribution and outliers in three
dimensions.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xyz_coord</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ellipseCoord.html">ellipseCoord</a></span><span class="op">(</span><span class="va">pca_scores</span>, pcx <span class="op">=</span> <span class="fl">1</span>, pcy <span class="op">=</span> <span class="fl">2</span>, pcz <span class="op">=</span> <span class="fl">3</span>, conf.limit <span class="op">=</span> <span class="fl">0.95</span>, pts <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">xyz_coord</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble [10,000 × 3] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ x: num [1:10000] 1.57e-11 1.57e-11 1.57e-11 1.57e-11 1.57e-11 ...</span></span>
<span><span class="co">#&gt;  $ y: num [1:10000] 1.97e-11 1.97e-11 1.97e-11 1.97e-11 1.97e-11 ...</span></span>
<span><span class="co">#&gt;  $ z: num [1:10000] 7745 7745 7745 7745 7745 ...</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">T2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ellipseParam.html">ellipseParam</a></span><span class="op">(</span><span class="va">pca_scores</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="va">Tsquare</span><span class="op">$</span><span class="va">value</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Christian L. Goueguel.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
